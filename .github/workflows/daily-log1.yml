name: Daily Log Commit
permissions:
  contents: write

on:
  schedule:
    - cron: "0 6 * * *"   # ĞºĞ°Ğ¶Ğ´Ñ‹Ğ¹ Ğ´ĞµĞ½ÑŒ 06:00 UTC
  workflow_dispatch:

jobs:
  log:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4

      - name: Append daily log
        run: |
          mkdir -p logs
          FILE="logs/$(date -u +'%Y-%m-%d').md"
          if [ ! -f "$FILE" ]; then
            {
              echo "## $(date -u +'%Y-%m-%d')"
              echo
              echo "**Done**"
              echo "- "
              echo
              echo "**Plan**"
              echo "- "
              echo
              echo "**Links**"
              echo "- "
            } > "$FILE"
          fi

      - name: Commit & push
        env:
          GH_TOKEN: ${{ secrets.PAT }}
        run: |
          git config user.name "Vlad Levinas"
          git config user.email "vladimir@dbits.lt"
          git add logs/
          git commit -m "ğŸ—“ï¸ Daily log $(date -u +'%F')" || exit 0
          git push https://$GH_TOKEN@github.com/${{ github.repository }} HEAD:${{ github.ref_name }}
